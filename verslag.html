<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Roeteplanner by HeinPauwelyn</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Roeteplanner</h1>
        <p>Project Android Applications + onderzoek Google Maps API voor Android</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/HeinPauwelyn/Roeteplanner" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/HeinPauwelyn/Roeteplanner/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/HeinPauwelyn/Roeteplanner/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul>
          <li class="tag-h0"><a href="index.html">Home</a></li>
          <li class="tag-h0"><a href="opgave.html">Opgave</a></li>
          <li class="tag-h0 active"><a href="verslag.html">Verslag</a><ul></ul></li>
        </ul>
      </nav>
      <section>
     <div class="markdown-body">

<h1>Doel van de applicatie</h1>

<p>Het doel is om gemakkelijk van het ene punt op aarde naar een ander punt gebracht te worden. Op de Google kaart vind je twee pinnen. Er wordt ook nog een lijn getrokken tussen beide punten voor in vogelvlucht uw bestemming te bereiken of via de auto gemakkelijk de kortste route te vinden.</p>

<p>Hier vind u twee screenshots van de kaart.</p>

<img src="https://cloud.githubusercontent.com/assets/16222780/17628030/c0196420-60b3-11e6-822e-35cf5af25978.png" width="250">
<img src="https://cloud.githubusercontent.com/assets/16222780/17628041/c8568924-60b3-11e6-8d58-2309d2e60e15.png" height="250">

<h1>Werking en screenshots van de applicatie</h1>

<p>Op het eerste scherm, kan je een vertrek- en aankomstpunt ingeven. Je kan op de vergrootglazen te drukken voor uw reeds eerder ingegeven locaties terug te vinden en opnieuw in te voeren op het middelste scherm. Tenslotte kan u op het laatste scherm een nieuwe locatie invoeren. Geef de locatie in, in het tekst vak en klik op de vernieuw knop voor de locatie te bevestigen. Dit gebruikt een API van Google voor het volledig adres en de coördinaten van de locatie te bepalen.</p>

<img src="https://cloud.githubusercontent.com/assets/16222780/17628140/3f6b8d16-60b4-11e6-9044-13903ee3f7a2.png" alt="image">

<p>Hieronder ziet u nog eens de fragmenten in landschap mode.</p>

<img src="https://cloud.githubusercontent.com/assets/16222780/17628180/69fab6ba-60b4-11e6-846d-f01769dac77c.png" alt="image">

<p>Met de navigation drawer kan je gemakkelijk gaan navigeren tussen de verschillende fragmenten.</p>

<img src="https://cloud.githubusercontent.com/assets/16222780/17629116/184886da-60b9-11e6-9c46-98f5b2ec6c6a.png" width="250">

<h1>Realisatie</h1>

<h2>De kaart</h2>

<p>De Google kaart werd gerealiseerd door een nieuwe <em>'Google Maps Acticity'</em> toe te voegen. Hier heb ik echter een paar zaken aangepast. Ten eerste heb ik de <code>Activity</code> aangepast door een <code>Fragment</code> te gebruiken en de <code>newInstance()</code> methode te overschrijven waardoor ik een eigen object genaamd <code>Route</code>.</p>

<img src="https://cloud.githubusercontent.com/assets/16222780/17628230/bd7b694c-60b4-11e6-998a-f3ec2d198f79.png" alt="image">

<p>Vervolgens werd er in de <code>onMapReady(GoogleMap)</code> code toegevoegd voor het plaatsen van de pinnen en de polygoon. Deze is als volgt opgemaakt.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">if</span> (_route <span class="pl-k">!=</span> <span class="pl-c1">null</span> <span class="pl-k">&amp;&amp;</span> _route<span class="pl-k">.</span>getAankomstLocatie() <span class="pl-k">!=</span> <span class="pl-c1">null</span> <span class="pl-k">&amp;&amp;</span> _route<span class="pl-k">.</span>getVertrekLocatie() <span class="pl-k">!=</span> <span class="pl-c1">null</span>) 
{
    <span class="pl-smi">LatLng</span> aankomst <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">LatLng</span>(_route<span class="pl-k">.</span>getAankomstLocatie()<span class="pl-k">.</span>getLatitude(), _route<span class="pl-k">.</span>getAankomstLocatie()<span class="pl-k">.</span>getLongitude());
    googleMap<span class="pl-k">.</span>addMarker(<span class="pl-k">new</span> <span class="pl-smi">MarkerOptions</span>()<span class="pl-k">.</span>position(aankomst)<span class="pl-k">.</span>title(<span class="pl-s"><span class="pl-pds">"</span>aankomst<span class="pl-pds">"</span></span>));
    googleMap<span class="pl-k">.</span>moveCamera(<span class="pl-smi">CameraUpdateFactory</span><span class="pl-k">.</span>newLatLng(aankomst));

    <span class="pl-smi">LatLng</span> vertrek <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">LatLng</span>(_route<span class="pl-k">.</span>getVertrekLocatie()<span class="pl-k">.</span>getLatitude(), _route<span class="pl-k">.</span>getVertrekLocatie()<span class="pl-k">.</span>getLongitude());
    googleMap<span class="pl-k">.</span>addMarker(<span class="pl-k">new</span> <span class="pl-smi">MarkerOptions</span>()<span class="pl-k">.</span>position(vertrek)<span class="pl-k">.</span>title(<span class="pl-s"><span class="pl-pds">"</span>vertrek<span class="pl-pds">"</span></span>));
    googleMap<span class="pl-k">.</span>moveCamera(<span class="pl-smi">CameraUpdateFactory</span><span class="pl-k">.</span>newLatLng(vertrek));

    googleMap<span class="pl-k">.</span>addPolygon(<span class="pl-k">new</span> <span class="pl-smi">PolygonOptions</span>()<span class="pl-k">.</span>add(aankomst, vertrek)<span class="pl-k">.</span>fillColor(<span class="pl-smi">Color</span><span class="pl-c1"><span class="pl-k">.</span>BLUE</span>)<span class="pl-k">.</span>strokeWidth(<span class="pl-c1">2</span>));
}</pre></div>

<p>Hier kwam ik een paar problemen tegen.</p>

<ul>
<li>Het eerste probleem was dat de kaart niet wilde reageren op de acties van de gebruiker. Dit is ondertussen opgelost door de support library te negeren.</li>
<li>Ook wilde de kaart niet meer opnieuw laden als de gebruiker hem voor een tweede keer wilt weergeven. Dit is opgelost door het antwoord op <a href="http://stackoverflow.com/questions/14083950/duplicate-id-tag-null-or-parent-id-with-another-fragment-for-com-google-androi/14695397#14695397">deze vraag op Stack Overflow</a>.</li>
<li>Het derde en het laatste probleem was dat de <code>onMapReady(GoogleMap)</code> methode niet uitgevoerd werd als de kaart geladen was. Door het toevoegen van onderstaande code was dit opgelost.</li>
</ul>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">MapFragment</span> mapFragment <span class="pl-k">=</span> (<span class="pl-smi">MapFragment</span>) getFragmentManager()<span class="pl-k">.</span>findFragmentById(<span class="pl-smi">R</span><span class="pl-k">.</span>id<span class="pl-k">.</span>mapFragment);
mapFragment<span class="pl-k">.</span>getMapAsync(<span class="pl-smi">RoeteActivity</span><span class="pl-k">.</span><span class="pl-v">this</span>);</pre></div>

<h2>Verkrijgen van de coördinaten</h2>

<p>Voor het verkrijgen van de coördinaten op de nieuwe locatie activity, wordt er een API van Google met volgende URL:</p>

<pre><a href="http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;language=nlbe&amp;address=graaf%20karel%20de%20goedelaan%20kortrijk">http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;language=nlbe&amp;address=<b>graaf%20karel%20de%20goedelaan%20kortrijk</b></a></pre>

<p>Het vette gedeelte is het ingevoerde adres op de activity. Google houd rekening met typ- en spellingfouten. De teruggekeerde JSON data wordt hierna uitgelezen, verwerkt, gestockeerd in de opslagplaats en teruggestuurd naar de activity.</p>

<h2>Opslaan van ingevoerde plaatsen</h2>

<p>De <code>LocatieRepo</code> wordt gebruikt om de ingevoerde plaatsen weg te schrijven als local storage op het toestel. Voor alle locaties weg te schrijven in inlezen wordt er JSON gebruikt.</p>

<h1>Bronmateriaal en documentatie</h1>

<ul>
<li>Presentaties en demo’s <a href="https://github.com/walcariuss">dhr. <strong>@Walcarius</strong> S. </a> voor het vak Mobile App. Development</li>
<li>Afbeelding op navigation drawer: <a href="https://pixabay.com/en/map-location-navigation-symbol-525349/">pixabay.com</a>
</li>
<li>Logo applicatie: <a href="http://iconmonstr.com/crosshair-10/">iconmonstr.com</a>
</li>
<li>Stack Overflow: 

<ul>
<li><a href="http://stackoverflow.com/questions/36809284/mapview-onmapready-never-called-in-fragment-for-load-google-map-in-mapview"><code>mapview.onmapready()</code> never called in fragment for load google map in mapview</a></li>
<li><a href="http://stackoverflow.com/questions/37204838/loading-fragment-with-google-map-gives-exception-when-return">loading fragment with google map gives exception when return</a></li>
<li><a href="http://stackoverflow.com/questions/14083950/duplicate-id-tag-null-or-parent-id-with-another-fragment-for-com-google-androi/14695397#14695397">duplicate id tag null or parent id with another fragment for <code>com.google.android.gms.maps.MapFragment</code></a></li>
</ul>
</li>
<li>Google documentatie: <a href="https://developers.google.com/maps/documentation/android-api/">developers.google.com/maps</a>
</li>
</ul>

      </div>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/HeinPauwelyn">HeinPauwelyn</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
